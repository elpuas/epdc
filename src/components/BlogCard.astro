---
import type { CollectionEntry } from 'astro:content';
import { Image } from 'astro:assets';
import { t, type Language } from '../i18n/utils';

interface Props {
  post: CollectionEntry<'blog'>;
  lang: Language;
}

const { post, lang } = Astro.props;
const { title, description, image } = post.data;
const postUrl = `/${lang}/blog/${post.slug}`;

const readMore = t('common.readMore', lang);
const readMoreLabel = `${readMore} ${title}`;

// Provide fallback image if none specified
const displayImage = image || '/blog-placeholder-about.jpg';
---
<article class="blog-card">
  <a href={postUrl} aria-label={readMoreLabel}>
    <Image 
      src={displayImage} 
      alt={`Preview image for ${title}`} 
      width={400} 
      height={200} 
      loading="lazy"
      decoding="async"
      class="card-image"
    />
  </a>
  <div class="card-content">
    <h2 class="card-heading">
      <a href={postUrl} class="card-link">
        {title}
      </a>
    </h2>
    {description && (
      <p class="card-description">{description}</p>
    )}
    <a 
      href={postUrl} 
      class="card-link"
      aria-label={readMoreLabel}
    >
      {readMore} &rarr;
    </a>
  </div>
</article> 

<style>
  .blog-card {
    display: flex;
    flex-direction: column;
    gap: var(--space-xl);
    grid-column: span 3;
    margin-bottom: var(--space-xl);
    

    @media screen and (min-width: 768px) {
      flex-direction: row;
      align-items: flex-start;
      margin-bottom: var(--space-3xl);
    }

    &:hover {
      .card-image {
        filter: grayscale(0%);
      }
    }

    > a {
      flex-shrink: 0;
      width: 320px;
    }
  }

  .card-image {
    width: 100%;
    height: 200px;
    object-fit: cover;
    border-radius: 4px;
    filter: grayscale(100%);
    transition: filter 0.3s ease;

    &:hover {
      filter: grayscale(0%);
    }
  }

  .card-content {
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
  }

  .card-heading {
    font-size: var(--fontsize-h4);
    font-weight: 400;
    letter-spacing: 0;
    margin: 0;
    line-height: 0.5;

    a {
      font-size: inherit;
      line-height: 1;
    }
  }

  .card-description {
    font-size: var(--fontsize-base);
    margin: 0;
  }

  .card-link {
    text-transform: capitalize;
  }
  
</style>